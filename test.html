<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<title>Accordion Slider</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<style>
body, html { margin: 0; padding: 0; background: #000; overflow: hidden; width: 100%; height: 100%; }
.accordion-wrapper {
  display: flex;
  width: 100%;
  height: 100vh;
  background: #000;
  overflow: hidden;
}
.accordion-item {
  position: relative;
  flex-shrink: 0;
  width: 15%;
  height: 100%;
  overflow: hidden;
  border-right: 1px solid rgba(255,255,255,0.2);
  box-sizing: border-box;
}
.accordion-item:first-child {
  width: 40%;
}
.bg-image {
  position: absolute;
  top: 0;
  left: 50%;
  height: 100%;
  width: auto;
  min-width: 110%;
  object-fit: cover;
  transform: translateX(-50%);
}
.vertical-title {
  position: absolute;
  bottom: 50px;
  left: 50%;
  transform: translateX(-50%);
  writing-mode: vertical-rl;
  color: #fff;
  font-size: 3rem;
  letter-spacing: 0.5em;
  z-index: 10;
  pointer-events: none;
  text-shadow: 2px 2px 10px rgba(0,0,0,0.5);
}
</style>
</head>
<body>

<div class="accordion-wrapper" id="slider">
  <div class="accordion-item">
    <img class="bg-image" src="image1.webp">
    <h2 class="vertical-title">JAPAN</h2>
  </div>
  <div class="accordion-item">
    <img class="bg-image" src="image2.webp">
    <h2 class="vertical-title">ASIA</h2>
  </div>
  <div class="accordion-item">
    <img class="bg-image" src="image1.webp">
    <h2 class="vertical-title">EUROPE</h2>
  </div>
  <div class="accordion-item">
    <img class="bg-image" src="image2.webp">
    <h2 class="vertical-title">AMERICA</h2>
  </div>
  <div class="accordion-item">
    <img class="bg-image" src="image1.webp">
    <h2 class="vertical-title">AFRICA</h2>
  </div>
</div>

<script>
const slider = document.getElementById('slider');

// 全画像を中央にリセット
function resetAllImgs() {
  slider.querySelectorAll('.bg-image').forEach(img => {
    gsap.set(img, { xPercent: -50 });
  });
}
resetAllImgs();

let isAnimating = false;

function moveNext() {
  if (isAnimating) return;
  isAnimating = true;

  const items  = Array.from(slider.querySelectorAll('.accordion-item'));
  const first  = items[0];
  const second = items[1];

  const tl = gsap.timeline({
    onComplete: () => {
      slider.appendChild(first);
      gsap.set(slider, { x: 0 });
      resetAllImgs();
      isAnimating = false;
    }
  });

  // slider全体を左へ
  tl.to(slider, {
    x: '-15%',
    duration: 1.2,
    ease: 'power4.inOut'
  }, 0);

  // パネル幅変更
  tl.to(first,  { width: '15%', duration: 1.2, ease: 'power4.inOut' }, 0);
  tl.to(second, { width: '40%', duration: 1.2, ease: 'power4.inOut' }, 0);

  // 全パネルの画像を左へパン（毎回 -50% スタートで累積しない）
  items.forEach(item => {
    const img = item.querySelector('.bg-image');
    tl.fromTo(img,
      { xPercent: -50 },
      { xPercent: -65, duration: 1.2, ease: 'power4.inOut' },
      0
    );
  });
}

setInterval(moveNext, 2000);
</script>
</body>
</html>